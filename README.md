# ğŸ“ AI æ ¡å›­ç™¾äº‹é€š (AI Campus Counselor)

> **æ–°ä¸€ä»£ AI å¯¼å¸ˆï¼šä¸€ä¸ªä¼šé™ªä½ å­¦ä¹ ã€ç»ƒä¹ ä¸æˆé•¿çš„æ•°å­—äººè€å¸ˆã€‚**
>
> ğŸ† **å‚èµ›èµ›é“**ï¼šAI å®æ—¶äº¤äº’æ•™è‚² â€”â€” æŠŠå­¦ä¹ ä»"çœ‹å†…å®¹"å‡çº§ä¸º"å®æ—¶å¯¹è¯ä¸é™ªç»ƒ"ã€‚

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Vue](https://img.shields.io/badge/Frontend-Vue.js_3-42b883.svg)
![Node](https://img.shields.io/badge/Backend-Node.js-339933.svg)
![GLM-4](https://img.shields.io/badge/AI-GLM--4-purple.svg)
![RAG](https://img.shields.io/badge/RAG-Hybrid_Retrieval-green.svg)
![Multi-Agent](https://img.shields.io/badge/Architecture-Multi--Agent-orange.svg)
![Embedding](https://img.shields.io/badge/Embedding-Vector_Search-blue.svg)

---

## ğŸ”¥ æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹

> **æœ¬é¡¹ç›®ä¸æ˜¯ç®€å•çš„ LLM + Prompt é—®ç­”ç³»ç»Ÿï¼Œè€Œæ˜¯æ·±åº¦é›†æˆäº† RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ + Multi-Agent æ™ºèƒ½è·¯ç”±æ¶æ„ã€‚**

| æŠ€æœ¯èƒ½åŠ› | å®ç°æ–¹å¼ | æ•ˆæœ |
|---------|---------|------|
| **RAG æ£€ç´¢å¢å¼º** | å‘é‡æ•°æ®åº“ + æ··åˆæ£€ç´¢ï¼ˆè¯­ä¹‰+å…³é”®è¯ï¼‰ | åŸºäºçŸ¥è¯†åº“å‡†ç¡®å›ç­”ï¼Œé™ä½ AI å¹»è§‰ |
| **Multi-Agent åä½œç¼–æ’** | Planner â†’ Specialist â†’ Verifier â†’ Finalizerï¼ˆå¤šæ¬¡ LLM è°ƒç”¨ï¼‰ | å¤šè§’è‰²äº¤å‰æ ¡éªŒï¼Œé™ä½å¹»è§‰ä¸æ¼å¼•ç”¨ |
| **çŸ¥è¯†åº“ç®¡ç†** | ç»“æ„åŒ– JSON + è‡ªåŠ¨å‘é‡åŒ– | æ”¯æŒ 22+ æ–‡æ¡£ï¼Œ8 å¤§åˆ†ç±» |
| **3D æ•°å­—äºº** | Xmov SDK + å®æ—¶è¯­éŸ³åŒæ­¥ | æä¾›æ‹ŸäººåŒ–çš„äº¤äº’ä½“éªŒ |

## ğŸ“– é¡¹ç›®ç®€ä»‹ (Introduction)

**AI æ ¡å›­ç™¾äº‹é€š** æ˜¯ä¸€æ¬¾ä¸“ä¸ºé«˜æ ¡åœºæ™¯æ‰“é€ çš„æ™ºèƒ½æ•™è‚²ä¸æœåŠ¡ç»ˆç«¯ã€‚åŒºåˆ«äºä¼ ç»Ÿçš„ FAQ åˆ—è¡¨æˆ–çº¯æ–‡æœ¬èŠå¤©æœºå™¨äººï¼Œæœ¬é¡¹ç›®æ·±åº¦èåˆäº† **GLM-4 å¤§æ¨¡å‹**ã€**RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ**ã€**Multi-Agent æ¶æ„** ä¸ **æ˜Ÿäº‘ (Xmov) 3D æ•°å­—äºº**ï¼Œæ—¨åœ¨ä¸ºå­¦ç”Ÿæä¾›ä¸€ä¸ª"æœ‰èº«ä½“ã€æœ‰æ¸©åº¦ã€æœ‰æ™ºæ…§"çš„ **AI ä¼´å­¦å¯¼å¸ˆ**ã€‚

å®ƒä¸ä»…èƒ½ä½œä¸º**"ç™¾äº‹é€š"**è§£ç­”æ ¡å›­ç”Ÿæ´»çäº‹ï¼ˆå¦‚åŠäº‹æµç¨‹ã€å¥–å­¦é‡‘ç”³è¯·ï¼‰ï¼Œæ›´èƒ½åŒ–èº«ä¸º**"ä¸“ä¸šå¯¼å¸ˆ"**ï¼Œåœ¨é¢è¯•æ¨¡æ‹Ÿã€å£è¯­é™ªç»ƒã€å­¦ç§‘è€ƒæ ¸ç­‰åœºæ™¯ä¸‹ï¼Œæä¾›æ²‰æµ¸å¼çš„ **1 å¯¹ 1 å®æ—¶é™ªç»ƒä¸è¯„æµ‹åé¦ˆ**ï¼ŒçœŸæ­£å®ç°"æ•™-ç»ƒ-è¯„"çš„æ•™è‚²é—­ç¯ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ (Architecture)

```
                              ç”¨æˆ·è¾“å…¥
                                  â”‚
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Multi-Agent Orchestrator     â”‚
                    â”‚ (multiAgentOrchestrator.js)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ PlannerAgent (route + plan)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚ needsRAG?
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â–¼                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ RAG Pipeline (KB)   â”‚   â”‚ Web Search (Firecrawl)â”‚
            â”‚ vectorStore/ragSvc  â”‚   â”‚ optional             â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ SpecialistAgent (draft)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ VerifierAgent (anti-hallu)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ FinalizerAgent (final answer)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      GLM-4 LLM          â”‚ â—„â”€â”€ å¤šæ¬¡è°ƒç”¨ï¼ˆplanner/draft/verify/finalï¼‰
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   3D æ•°å­—äºº (Xmov)       â”‚ â—„â”€â”€ TTS + å£å‹åŒæ­¥
                    â”‚   å®æ—¶è¯­éŸ³æ’­æŠ¥           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š æŠ€æœ¯å®ç°å¯¹æ¯”

| ç‰¹æ€§ | ä¼ ç»Ÿ LLM + Prompt | æœ¬é¡¹ç›®å®ç° |
|-----|------------------|-----------|
| **çŸ¥è¯†æ¥æº** | ä»…ä¾èµ–æ¨¡å‹é¢„è®­ç»ƒçŸ¥è¯† | RAG æ£€ç´¢æœ¬åœ°çŸ¥è¯†åº“ + æ¨¡å‹çŸ¥è¯† |
| **å‡†ç¡®æ€§** | å®¹æ˜“äº§ç”Ÿå¹»è§‰ | ä¼˜å…ˆå¼•ç”¨çŸ¥è¯†åº“ï¼Œæ ‡æ³¨æ¥æº |
| **åœºæ™¯é€‚é…** | å•ä¸€ Prompt | Multi-Agent åŠ¨æ€è·¯ç”± |
| **å¯æ‰©å±•æ€§** | éœ€é‡æ–°è®­ç»ƒ/å¾®è°ƒ | åªéœ€æ›´æ–°çŸ¥è¯†åº“ JSON |
| **å“åº”ç­–ç•¥** | å›ºå®šæ¨¡æ¿ | æ ¹æ® Agent ç±»å‹å®šåˆ¶ System Prompt |

## ğŸ› ï¸ æŠ€æœ¯æ ˆ (Tech Stack)

### å‰ç«¯ (Frontend)
- **Framework**: Vue 3 + Vite
- **Styling**: Modern CSS3 (Flexbox/Grid), Responsive Design
- **Markdown**: `markdown-it` (å®æ—¶æµå¼æ¸²æŸ“)
- **Digital Human**: Xmov Embodied Driver SDK (3D æ•°å­—äººé©±åŠ¨)

### åç«¯ (Backend)
- **Runtime**: Node.js
- **Server**: Express.js
- **Communication**: Server-Sent Events (SSE) æµå¼ä¼ è¾“
- **AI Core**: æ™ºè°± AI (GLM-4 + Embedding-2)
- **RAG**: å†…å­˜å‘é‡æ•°æ®åº“ + ä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢
- **Multi-Agent**: å¤š Agent åä½œç¼–æ’ï¼ˆPlanner/Specialist/Verifier/Finalizerï¼‰+ åœºæ™¯è·¯ç”±

## ğŸ“‚ é¡¹ç›®ç»“æ„ (Project Structure)

```
AI_Campus_Counselor/
â”œâ”€â”€ backend/                        # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ knowledge/                  # ğŸ†• çŸ¥è¯†åº“ç›®å½•
â”‚   â”‚   â””â”€â”€ campus_knowledge.json   # æ ¡å›­çŸ¥è¯†æ•°æ®
â”‚   â”œâ”€â”€ routes/                     # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ chat.js                 # èŠå¤©æ¥å£
â”‚   â”‚   â””â”€â”€ config.js               # é…ç½®æ¥å£
â”‚   â”œâ”€â”€ services/                   # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ chatService.js          # èŠå¤©æœåŠ¡ (é›†æˆRAG+è·¯ç”±)
â”‚   â”‚   â”œâ”€â”€ configService.js        # é…ç½®æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ embeddingService.js     # ğŸ†• Embedding å‘é‡åŒ–æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ vectorStore.js          # ğŸ†• å‘é‡å­˜å‚¨ä¸æ£€ç´¢
â”‚   â”‚   â”œâ”€â”€ ragService.js           # ğŸ†• RAG æ£€ç´¢æœåŠ¡
â”‚   â”‚   â””â”€â”€ agentRouter.js          # ğŸ†• Multi-Agent è·¯ç”±
â”‚   â”œâ”€â”€ server.js                   # Express å…¥å£
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ .env                        # ç¯å¢ƒé…ç½®
â”œâ”€â”€ src/                            # å‰ç«¯æºç 
â”‚   â”œâ”€â”€ components/                 # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DigitalHuman.vue        # æ•°å­—äººç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatBox.vue             # èŠå¤©æ¡†ç»„ä»¶
â”‚   â”‚   â””â”€â”€ QuickBubbles.vue        # å¿«æ·æ“ä½œç»„ä»¶
â”‚   â”œâ”€â”€ services/                   # API æœåŠ¡
â”‚   â”‚   â””â”€â”€ api.js                  # åç«¯ API è°ƒç”¨
â”‚   â”œâ”€â”€ views/                      # é¡µé¢ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ChatInterface.vue       # ä¸»èŠå¤©ç•Œé¢
â”‚   â”œâ”€â”€ router/                     # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ App.vue                     # ä¸»å¸ƒå±€
â”‚   â”œâ”€â”€ main.js                     # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ style.css                   # å…¨å±€æ ·å¼
â”œâ”€â”€ index.html                      # HTML å…¥å£
â”œâ”€â”€ vite.config.js                  # Vite é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Quick Start)

### 1. ç¯å¢ƒå‡†å¤‡
ç¡®ä¿æ‚¨çš„æœ¬åœ°ç¯å¢ƒå·²å®‰è£…ï¼š
- Node.js >= 18.0.0
- npm æˆ– yarn

### 2. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/YJduck123/ai-campus-counselor.git
cd ai-campus-counselor
```

### 3. åç«¯é…ç½®ä¸å¯åŠ¨
è¿›å…¥åç«¯ç›®å½•ï¼Œå®‰è£…ä¾èµ–å¹¶é…ç½®ç¯å¢ƒå˜é‡ã€‚

```bash
cd backend
npm install
```

åˆ›å»º `.env` æ–‡ä»¶å¹¶å¡«å…¥å¿…è¦çš„ API Keyï¼š
```env
# æ™ºè°± AI (å¿…å¡«ï¼Œç”¨äºæ ¸å¿ƒå¯¹è¯å’ŒEmbedding)
GLM_API_KEY=your_glm_api_key_here

# é­”çæ˜Ÿäº‘æ•°å­—äºº (Xmov)
XMOV_APP_ID=your_xmov_app_id_here
XMOV_APP_SECRET=your_xmov_app_secret_here

# Firecrawl (é€‰å¡«ï¼Œç”¨äºè”ç½‘æœç´¢è¡¥å……)
FIRECRAWL_API_KEY=your_firecrawl_api_key_here

# å¯é€‰ï¼šå¤š Agent ç¼–æ’è¿‡ç¨‹å›æ˜¾ï¼ˆè°ƒè¯•ç”¨ï¼Œå‰ç«¯å¯å±•ç¤º planner/draft/verifier/finalï¼‰
AGENT_TRACE=1

# ç«¯å£é…ç½®
PORT=3000
```

å¯åŠ¨åç«¯æœåŠ¡ï¼š
```bash
npm run dev
# æœåŠ¡å°†åœ¨ http://localhost:3000 å¯åŠ¨
# å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åŠ è½½çŸ¥è¯†åº“å¹¶åˆå§‹åŒ–RAGç³»ç»Ÿ
```

### 4. å‰ç«¯å¯åŠ¨
æ–°å»ºä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œå›åˆ°é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨å‰ç«¯ã€‚

```bash
# å›åˆ°æ ¹ç›®å½•
cd ..
npm install
npm run dev
# è®¿é—® http://localhost:5173 å³å¯ä½“éªŒ
```

## âœ¨ æ ¸å¿ƒåŠŸèƒ½ (Core Features)

### 1. ğŸ¤– Multi-Agent æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ

> **æ–‡ä»¶**: `backend/services/agentRouter.js`

ç³»ç»ŸåŸºäºç”¨æˆ·è¾“å…¥è‡ªåŠ¨è¿›è¡Œ**æ„å›¾è¯†åˆ«**ï¼Œé€šè¿‡å…³é”®è¯åŒ¹é…å’Œä¸Šä¸‹æ–‡åˆ†æï¼Œå°†è¯·æ±‚è·¯ç”±åˆ°æœ€åˆé€‚çš„ä¸“ä¸š Agentï¼š

| Agent ç±»å‹ | èŒè´£ | è§¦å‘å…³é”®è¯ç¤ºä¾‹ | æ˜¯å¦å¯ç”¨ RAG |
|-----------|------|---------------|-------------|
| `knowledge` | æ ¡å›­çŸ¥è¯†é—®ç­” | å›¾ä¹¦é¦†ã€å¥–å­¦é‡‘ã€é€‰è¯¾ã€å®¿èˆã€æŠ¥åˆ°... | âœ… æ˜¯ |
| `tutor` | é™ªç»ƒè¯„æµ‹æ¨¡å¼ | é¢è¯•ã€ç»ƒä¹ ã€è€ƒæ ¸ã€æ¨¡æ‹Ÿã€é™ªç»ƒ... | âŒ å¦ |
| `general` | æ—¥å¸¸èŠå¤© | å…¶ä»–æƒ…å†µ | âŒ å¦ |

**è·¯ç”±å†³ç­–æµç¨‹**:
```javascript
// 1. æ£€æŸ¥æ˜¯å¦æ˜¯é™ªç»ƒæ¨¡å¼å…³é”®è¯
// 2. æ£€æŸ¥å¯¹è¯å†å²æ˜¯å¦åœ¨é™ªç»ƒä¼šè¯ä¸­
// 3. æ£€æŸ¥æ˜¯å¦åŒ…å«æ ¡å›­çŸ¥è¯†å…³é”®è¯
// 4. é»˜è®¤ä½¿ç”¨é€šç”¨å¯¹è¯ Agent
```

**è¿è¡Œæ—¶æ—¥å¿—ç¤ºä¾‹**:
```
[Router] Agent: knowledge, NeedsRAG: true, Confidence: 0.95
[Router] Agent: tutor, NeedsRAG: false, Confidence: 0.9
```

#### 1.1 ğŸ§  å¤š Agent åä½œç¼–æ’ï¼ˆå‡çº§ç‰ˆï¼‰

> **æ–‡ä»¶**: `backend/services/multiAgentOrchestrator.js`, `backend/services/llmClient.js`

ç³»ç»Ÿé€šè¿‡ **å¤šæ¬¡ LLM è°ƒç”¨çš„åä½œé“¾è·¯** è¿›è¡Œè§„åˆ’ã€ç”Ÿæˆã€æ ¡éªŒä¸æœ€ç»ˆæ•´åˆï¼š

```
PlannerAgent  ->  (RAG/è”ç½‘æ£€ç´¢)  ->  SpecialistAgent(Draft)
      ->  VerifierAgent(æŸ¥å¹»è§‰/è¡¥å¼•ç”¨)  ->  FinalizerAgent(æœ€ç»ˆå›ç­”+å¼•ç”¨)
```

- PlannerAgentï¼šå¯¹æ„å›¾ä¸æ˜¯å¦éœ€è¦æ£€ç´¢åšäºŒæ¬¡åˆ¤æ–­ï¼ˆè¾“å‡º JSON å†³ç­–ï¼‰
- SpecialistAgentï¼šæŒ‰åœºæ™¯äº§å‡ºè‰ç¨¿ï¼ˆå¼ºåˆ¶ [KB1]/[KB2] å¼•ç”¨ï¼‰
- VerifierAgentï¼šæ£€æŸ¥â€œæ ¡å›­ç‰¹å®šäº‹å®â€æ˜¯å¦æœ‰ä¾æ®/æ˜¯å¦ç¼ºå¼•ç”¨
- FinalizerAgentï¼šæ ¹æ® verifier åé¦ˆé‡å†™ä¸ºæœ€ç»ˆç­”æ¡ˆï¼Œå¹¶é™„â€œå‚è€ƒèµ„æ–™â€å°èŠ‚

å¯é€‰å¼€å¯ç¼–æ’è¿‡ç¨‹å›æ˜¾ï¼ˆè°ƒè¯•ç”¨ï¼‰ï¼š
```bash
AGENT_TRACE=1
```

---

### 2. ğŸ“š RAG æ£€ç´¢å¢å¼ºç”Ÿæˆç³»ç»Ÿ

> **æ–‡ä»¶**: `backend/services/ragService.js`, `vectorStore.js`, `embeddingService.js`

#### RAG å¤„ç†æµç¨‹

```
ç”¨æˆ·é—®é¢˜: "å¦‚ä½•ç”³è¯·å›½å®¶åŠ±å¿—å¥–å­¦é‡‘ï¼Ÿ"
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. æ–‡æœ¬å‘é‡åŒ–       â”‚ â† è°ƒç”¨æ™ºè°± Embedding-2 API
    â”‚  (embeddingService) â”‚   ç”Ÿæˆ 1024 ç»´å‘é‡
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  2. æ··åˆæ£€ç´¢         â”‚
    â”‚  â”œâ”€ å‘é‡ç›¸ä¼¼åº¦ (0.7) â”‚ â† ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—
    â”‚  â””â”€ å…³é”®è¯åŒ¹é… (0.3) â”‚ â† ç²¾ç¡®å…³é”®è¯å‘½ä¸­
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  3. Top-K ç»“æœ       â”‚ â† å–ç›¸å…³åº¦æœ€é«˜çš„ 3 æ¡
    â”‚  (é˜ˆå€¼è¿‡æ»¤ > 0.4)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  4. ä¸Šä¸‹æ–‡æ„å»º       â”‚
    â”‚  æ ¼å¼åŒ–ä¸ºå‚è€ƒèµ„æ–™     â”‚ â†’ æ³¨å…¥åˆ° LLM Prompt
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒä»£ç å®ç°

**å‘é‡æ£€ç´¢** (`vectorStore.js`):
```javascript
// ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—
function cosineSimilarity(a, b) {
    let dotProduct = 0, normA = 0, normB = 0;
    for (let i = 0; i < a.length; i++) {
        dotProduct += a[i] * b[i];
        normA += a[i] * a[i];
        normB += b[i] * b[i];
    }
    return dotProduct / (Math.sqrt(normA) * Math.sqrt(normB));
}

// æ··åˆæ£€ç´¢ï¼šå‘é‡ 70% + å…³é”®è¯ 30%
async function hybridSearch(query, topK = 3) {
    const [vectorResults, keywordResults] = await Promise.all([
        search(query, topK, 0.4),      // å‘é‡æ£€ç´¢
        keywordSearch(query, topK)      // å…³é”®è¯æ£€ç´¢
    ]);
    // åŠ æƒåˆå¹¶å»é‡...
}
```

**RAG å¢å¼º Prompt** (`ragService.js`):
```javascript
function buildAugmentedPrompt(userQuery, context) {
    return `ä»¥ä¸‹æ˜¯ä»æ ¡å›­çŸ¥è¯†åº“ä¸­æ£€ç´¢åˆ°çš„ç›¸å…³å‚è€ƒä¿¡æ¯ï¼š

${context}

---

è¯·åŸºäºä»¥ä¸Šå‚è€ƒä¿¡æ¯ï¼Œå‡†ç¡®å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœå‚è€ƒä¿¡æ¯ä¸è¶³ï¼Œ
å¯ä»¥è¡¥å……è¯´æ˜ï¼Œä½†è¦æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·å“ªäº›æ˜¯æ¥è‡ªçŸ¥è¯†åº“çš„å‡†ç¡®ä¿¡æ¯ã€‚

ç”¨æˆ·é—®é¢˜ï¼š${userQuery}`;
}
```

#### çŸ¥è¯†åº“ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|-----|------|
| æ–‡æ¡£æ€»æ•° | 22 æ¡ |
| åˆ†ç±»æ•° | 8 ä¸ª |
| è¦†ç›–èŒƒå›´ | æ–°ç”Ÿå…¥å­¦ã€å›¾ä¹¦é¦†ã€å¥–åŠ©å­¦é‡‘ã€å®¿èˆç”Ÿæ´»ã€é¤é¥®æœåŠ¡ã€æ•™åŠ¡å­¦ä¸šã€åŒ»ç–—å¥åº·ã€æ ¡å›­æœåŠ¡ |

**è¿è¡Œæ—¶æ—¥å¿—ç¤ºä¾‹**:
```
[RAG] Performing knowledge retrieval...
[RAG] Retrieved 3 relevant documents
```

---

### 3. ğŸ“ å…¨åœºæ™¯ AI å¯¼å¸ˆé™ªç»ƒ
ç‚¹å‡» **"å¼€å¯ AI å¯¼å¸ˆé™ªç»ƒ"** è§¦å‘ï¼š
- **é¢è¯•æ¨¡æ‹Ÿ**ï¼šæ”¯æŒå­¦ç”Ÿä¼šæ‹›æ–°ã€å¤§å‚æ±‚èŒç­‰åœºæ™¯
- **å®æ—¶è¯„æµ‹**ï¼šæ¯è½®å¯¹è¯ç»™å‡º **ã€è¯„æµ‹å»ºè®®ã€‘**
- **å£è¯­/å­¦ç§‘é™ªç»ƒ**ï¼šæ”¯æŒè‹±è¯­å¯¹ç»ƒã€çŸ¥è¯†ç‚¹è€ƒæ ¸

### 4. ğŸ‘¤ 3D æ•°å­—äººå¤šæ¨¡æ€äº¤äº’
- **éŸ³ç”»åŒæ­¥**ï¼šAI å›å¤å®æ—¶è½¬è¯­éŸ³ï¼Œé©±åŠ¨æ•°å­—äººå˜´å‹
- **çŠ¶æ€åˆ‡æ¢**ï¼šå€¾å¬ã€æ€è€ƒã€è®²è§£ç­‰å¤šç§çŠ¶æ€

## ğŸ”Œ API æ¥å£ (API Reference)

### å¯¹è¯æ¥å£
- **Endpoint**: `POST /api/chat`
- **Response**: SSE æµå¼å“åº”ï¼ŒåŒ…å«ï¼š
  - `type: 'routing'` - è·¯ç”±ä¿¡æ¯ï¼ˆAgent ç±»å‹ã€ç½®ä¿¡åº¦ï¼‰
  - `type: 'text'` - AI å›å¤æ–‡æœ¬ï¼ˆæµå¼ï¼‰
  - `type: 'sources'` - RAG æ£€ç´¢æ¥æº
  - `type: 'done'` - å®Œæˆæ ‡è®°

### RAG çŠ¶æ€æ¥å£
- **Endpoint**: `GET /api/rag/status`
- **Response**:
  ```json
  {
    "success": true,
    "documentCount": 24,
    "isInitialized": true,
    "categories": ["æ–°ç”Ÿå…¥å­¦", "å›¾ä¹¦é¦†", "å¥–åŠ©å­¦é‡‘", ...]
  }
  ```

### å¥åº·æ£€æŸ¥
- **Endpoint**: `GET /health`
- **Response**: åŒ…å« RAG ç³»ç»ŸçŠ¶æ€

## ğŸ“Š çŸ¥è¯†åº“ç®¡ç†

çŸ¥è¯†åº“ä½äº `backend/knowledge/campus_knowledge.json`ï¼Œé‡‡ç”¨ç»“æ„åŒ– JSON æ ¼å¼ï¼š

```json
{
  "categories": [
    {
      "name": "æ–°ç”Ÿå…¥å­¦",
      "items": [
        {
          "id": "enroll_001",
          "question": "æ–°ç”ŸæŠ¥åˆ°æµç¨‹æ˜¯ä»€ä¹ˆ",
          "answer": "è¯¦ç»†çš„æŠ¥åˆ°æµç¨‹è¯´æ˜...",
          "keywords": ["æŠ¥åˆ°", "å…¥å­¦", "æ–°ç”Ÿ"]
        }
      ]
    }
  ]
}
```

**æ‰©å±•çŸ¥è¯†åº“**ï¼š
1. æŒ‰æ ¼å¼æ·»åŠ æ–°çš„é—®ç­”æ¡ç›®
2. é‡å¯åç«¯æœåŠ¡ï¼ˆè‡ªåŠ¨é‡æ–°åŠ è½½å’Œå‘é‡åŒ–ï¼‰

## â“ å¸¸è§é—®é¢˜ (FAQ)

**Q: RAG ç³»ç»Ÿæ²¡æœ‰åˆå§‹åŒ–æˆåŠŸï¼Ÿ**
A: æ£€æŸ¥ `GLM_API_KEY` æ˜¯å¦é…ç½®æ­£ç¡®ï¼ŒEmbedding æœåŠ¡éœ€è¦æ­¤ Keyã€‚

**Q: æ•°å­—äººä¸ºä»€ä¹ˆæ²¡æœ‰å£°éŸ³ï¼Ÿ**
A: æµè§ˆå™¨é™åˆ¶è‡ªåŠ¨æ’­æ”¾éŸ³é¢‘ã€‚è¯·å…ˆç‚¹å‡»é¡µé¢ä¸Šçš„ä»»æ„æŒ‰é’®è§¦å‘äº¤äº’ã€‚

**Q: å¦‚ä½•æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸ª Agentï¼Ÿ**
A: åç«¯æ§åˆ¶å°ä¼šæ‰“å°è·¯ç”±ä¿¡æ¯ï¼š`[Router] Agent: knowledge, NeedsRAG: true`

## ğŸ“„ å¼€æºåè®® (License)

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

## ğŸ™ è‡´è°¢ (Acknowledgements)

- **Zhipu AI (æ™ºè°±)**: æä¾› GLM-4 å¤§æ¨¡å‹å’Œ Embedding-2 API
- **Xmov (æ˜Ÿäº‘)**: æä¾›å¼ºå¤§çš„ 3D æ•°å­—äºº SDK
- **Firecrawl**: æä¾› Web æœç´¢èƒ½åŠ›

---

## ğŸ“‹ æŠ€æœ¯å®ç°æ¸…å• (Implementation Checklist)

> ä»¥ä¸‹æ˜¯æœ¬é¡¹ç›®å·²å®ç°çš„æ ¸å¿ƒæŠ€æœ¯èƒ½åŠ›ï¼ŒåŒºåˆ«äºç®€å•çš„ LLM + Prompt æ–¹æ¡ˆï¼š

### âœ… RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ
- [x] æœ¬åœ°çŸ¥è¯†åº“å­˜å‚¨ (`backend/knowledge/campus_knowledge.json`)
- [x] æ–‡æœ¬å‘é‡åŒ–æœåŠ¡ (`backend/services/embeddingService.js`)
- [x] å†…å­˜å‘é‡æ•°æ®åº“ (`backend/services/vectorStore.js`)
- [x] ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—
- [x] æ··åˆæ£€ç´¢ç­–ç•¥ï¼ˆå‘é‡ + å…³é”®è¯ï¼‰
- [x] RAG Pipeline å®Œæ•´æµç¨‹ (`backend/services/ragService.js`)
- [x] ä¸Šä¸‹æ–‡æ³¨å…¥ä¸ Prompt å¢å¼º
- [x] æ£€ç´¢æ¥æºè¿”å›å‰ç«¯

### âœ… Multi-Agent æ¶æ„
- [x] æ„å›¾è¯†åˆ«è·¯ç”±å™¨ (`backend/services/agentRouter.js`)
- [x] ä¸‰ç§ä¸“ä¸š Agentï¼ˆKnowledge / Tutor / Generalï¼‰
- [x] åŠ¨æ€ System Prompt åˆ‡æ¢
- [x] åŸºäºå¯¹è¯å†å²çš„ä¼šè¯å»¶ç»­
- [x] ç½®ä¿¡åº¦è¯„ä¼°æœºåˆ¶

### âœ… å®Œæ•´å¤„ç†é“¾è·¯
- [x] ç”¨æˆ·è¾“å…¥ â†’ è·¯ç”±å†³ç­– â†’ RAG æ£€ç´¢ â†’ Prompt å¢å¼º â†’ LLM ç”Ÿæˆ â†’ æ•°å­—äººæ’­æŠ¥
- [x] SSE æµå¼å“åº”
- [x] è·¯ç”±ä¿¡æ¯ + æ£€ç´¢æ¥æº å®æ—¶è¿”å›

---

*Built with â¤ï¸ by Claude Code & Vue.js*
